<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:cxf="http://camel.apache.org/schema/cxf"
    xmlns:http-conf="http://cxf.apache.org/transports/http/configuration"
    xmlns:util="http://www.springframework.org/schema/util"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="          http://www.springframework.org/schema/beans           http://www.springframework.org/schema/beans/spring-beans.xsd     http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd       http://camel.apache.org/schema/cxf           http://camel.apache.org/schema/cxf/camel-cxf.xsd                http://camel.apache.org/schema/spring                 http://camel.apache.org/schema/spring/camel-spring.xsd    http://cxf.apache.org/transports/http/configuration     http://cxf.apache.org/schemas/configuration/http-conf.xsd">
    <bean class="com.tml.IRN.LogAggregator" id="logger"/>
    <bean class="com.tml.IRN.ResponseProcessor" id="resProcessor"/>
    <cxf:cxfEndpoint address="http://localhost:8085/GenIRN" id="GenIRN" serviceClass="com.tml.IRN.IRNService">
        <cxf:properties>
            <entry key="dataFormat" value="MESSAGE"/>
        </cxf:properties>
    </cxf:cxfEndpoint>
    <cxf:rsClient
        address="http://dev-irn-api-1287737966.ap-south-1.elb.amazonaws.com/v1/en/push"
        id="rsGenIRN" loggingFeatureEnabled="true"/>
    <!-- Define a traditional camel context here -->
    <camelContext id="camel"
        xmlns="http://camel.apache.org/schema/spring" xmlns:com="http://com.tml.IRN" streamCache="true">
        <dataFormats>
            <jaxb contextPath="com.tml.IRN" id="xml"
                objectFactory="true" prettyPrint="true"/>
            <json id="json" library="Jackson" unmarshalTypeName="com.tml.IRN.ResponseObj"/>
            <json id="gson" library="Gson"/>
            <!-- <soapjaxb contextPath="com.tml.crm" id="soapxml" namespacePrefixRef="myMap"/>-->
        </dataFormats>
        <route id="simple-route">
            <!--  <from id="route-timer" uri="timer:foo?period=200"/> -->
            <from id="_from1" uri="cxf:bean:GenIRN"/>
            <log id="_log1" message="Request Received from CRM____${body}"/>
            
               <setHeader headerName="User">
                    <xpath resultType="java.lang.String">//com:IRNInput/User/text()</xpath>
                </setHeader>
				
				<log id="_log1" message="User_GSTIN__${header.User}"/>
                
                <!-- <setHeader headerName="TaxSch" id="_setHeader2">
                    <xpath resultType="java.lang.String">//com:IRNInput/TaxSch/text()</xpath>
                </setHeader>
                <setHeader headerName="pIrn" id="_setHeader3">
                    <xpath resultType="java.lang.String">//com:IRNInput/is_irn/text()</xpath>
                </setHeader>
                <setHeader headerName="pCnlRsn" id="_setHeader4">
                    <xpath resultType="java.lang.String">//com:IRNInput/TranDtls/catg/text()</xpath>
                </setHeader>
                <setHeader headerName="pCnlRem" id="_setHeader5">
                    <xpath resultType="java.lang.String">//com:IRNInput/TranDtls/claimingRefund/text()</xpath>
                </setHeader> -->
               
            <!-- <unmarshal id="_unmarshal1" ref="json"/>
             <to id="_to4" uri="xslt:classpath:xmltrnsform.xslt"/> -->
        </route>
    </camelContext>
</beans>
